---
title: Set-of-Mark
description: Set-of-Mark library for Agent
---

**Set-of-Mark (SOM)** is a visual grounding component for the Computer-Use Agent (CUA) framework powering Cua, for detecting and analyzing UI elements in screenshots. Optimized for macOS Silicon with Metal Performance Shaders (MPS), it combines YOLO-based icon detection with EasyOCR text recognition to provide comprehensive UI element analysis.

## Features

- Optimized for Apple Silicon with MPS acceleration
- Icon detection using YOLO with multi-scale processing
- Text recognition using EasyOCR (GPU-accelerated)
- Automatic hardware detection (MPS → CUDA → CPU)
- Smart detection parameters tuned for UI elements
- Detailed visualization with numbered annotations
- Performance benchmarking tools

## System Requirements

- **Recommended**: macOS with Apple Silicon
  - Uses Metal Performance Shaders (MPS)
  - Multi-scale detection enabled
  - ~0.4s average detection time
- **Supported**: Any Python 3.11+ environment
  - Falls back to CPU if no GPU available
  - Single-scale detection on CPU
  - ~1.3s average detection time

## Installation

```bash
pip install cua-som
```

Or install with the Agent SDK:

```bash
pip install "cua-agent[omni]"
```

## Quick Start

```python
from som import OmniParser
from PIL import Image

# Initialize parser
parser = OmniParser()

# Process an image
image = Image.open("screenshot.png")
result = parser.parse(
    image,
    box_threshold=0.3,    # Confidence threshold
    iou_threshold=0.1,    # Overlap threshold
    use_ocr=True         # Enable text detection
)

# Access results
for elem in result.elements:
    if elem.type == "icon":
        print(f"Icon: confidence={elem.confidence:.3f}, bbox={elem.bbox.coordinates}")
    else:  # text
        print(f"Text: '{elem.content}', confidence={elem.confidence:.3f}")
```

## Usage with Agent

Set-of-Mark is used by the Agent SDK's OmniParser loop for UI element detection. When using the OmniParser agent loop, Set-of-Mark is automatically used for grounding:

```python
from agent import ComputerAgent

# OmniParser loop uses Set-of-Mark automatically
agent = ComputerAgent(
    model="omniparser+anthropic/claude-sonnet-4-5-20250929",
    tools=[computer]
)
```

See the [Agent documentation](/agent/supported-agents/grounding-models) for more details on using Set-of-Mark with agents.

