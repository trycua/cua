name: Publish @trycua/computer to npm

on:
  push:
    branches: main
  workflow_dispatch:
    inputs:
      version:
        description: "Version to publish (default: from package.json)"
        required: false
        default: ""
  workflow_call:
    inputs:
      version:
        description: "Version to publish (default: from package.json)"
        required: false
        type: string
        default: ""

permissions:
  id-token: write
  contents: read

jobs:
  publish:
    uses: ./.github/workflows/npm-reusable-publish.yml
    with:
      package_name: "computer"
      package_dir: "libs/typescript/computer"
      package_manager: "pnpm"
      version: ${{ inputs.version || github.event.inputs.version || '' }}
    secrets:
      NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
