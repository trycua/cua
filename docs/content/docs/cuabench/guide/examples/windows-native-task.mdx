---
title: Native Windows Task
description: Create a task that runs in a Windows 11 virtual machine
---

In this tutorial, you'll create a task that runs in a full Windows 11 virtual machine. This is the foundation for Windows Arena-style benchmarks.

**Time:** ~2 hours (image creation) + 15 minutes (task)
**Prerequisites:** x86_64 Linux with KVM support

<Callout title="Requirements" type="warn">
  Windows QEMU requires:
  - x86_64 Linux host (not macOS or ARM)
  - KVM enabled (`/dev/kvm` accessible)
  - For cloud VMs: nested virtualization enabled
  - ~64GB disk space for the Windows image
</Callout>

## What You'll Build

A task where the agent must open Notepad, type a message, and save the file. You'll learn:

- Creating Windows 11 images (basic and with apps)
- Writing tasks for Windows applications
- Windows-specific considerations (app launch times, coordinates)

## Step 1: Create Windows Image

You have two options for creating the base image:

### Option A: Basic Windows Image

```bash
# Download Windows 11 ISO and create base image (~1-2 hours)
cb image create windows-qemu --download-iso
```

This creates a clean Windows 11 installation.

### Option B: Windows with Pre-installed Apps

```bash
# Create image with common apps pre-installed
cb image create windows-qemu --download-iso --apps chrome,notepad++,vscode
```

Available apps: `chrome`, `firefox`, `notepad++`, `vscode`, `vlc`, `libreoffice`, `7zip`, `gimp`

<Callout title="Monitor Progress" type="info">
  During image creation, monitor progress at `http://localhost:8006` (VNC). You can also watch logs:
  ```bash
  docker logs -f cua-setup-windows
  ```
</Callout>

## Step 2: Verify the Image

After creation, verify the image works:

```bash
cb image shell windows-qemu
```

Open `http://localhost:8006` in your browser. You should see the Windows 11 desktop.

- Try opening Notepad: `Win + R`, type `notepad`, press Enter
- Navigate the Start menu
- Note the screen resolution and UI element positions

Press `Ctrl+C` to stop when done.

## Step 3: Create Task Directory

```bash
mkdir -p tasks/win-notepad
cd tasks/win-notepad
```

## Step 4: Create the Task Configuration

Create `main.py`:

```python
import cua_bench as cb
from pathlib import Path


@cb.tasks_config(split="train")
def load():
    """Define Notepad task variants."""
    return [
        cb.Task(
            description="""
            Open Notepad and type "Hello from Cua-Bench!".
            Then save the file as "greeting.txt" on the Desktop.
            """,
            metadata={
                "content": "Hello from Cua-Bench!",
                "filename": "greeting.txt",
                "save_location": "Desktop"
            },
            computer={
                "provider": "native",
                "setup_config": {
                    "os_type": "windows",
                    "width": 1920,
                    "height": 1080,
                }
            }
        )
    ]


@cb.setup_task(split="train")
async def start(task_cfg: cb.Task, session: cb.DesktopSession):
    """Initialize the Windows environment."""
    # Wait for Windows to be fully ready
    # Windows VMs need more startup time than Linux
    await session.execute_action(cb.WaitAction(seconds=5.0))


@cb.evaluate_task(split="train")
async def evaluate(task_cfg: cb.Task, session: cb.DesktopSession) -> list[float]:
    """Check if the file was created correctly."""

    # Take screenshot for debugging
    screenshot = await session.screenshot()
    Path("debug_screenshot.png").write_bytes(screenshot)

    # In production, you would:
    # 1. Check if file exists on Desktop
    # 2. Verify file contents
    # For now, return placeholder

    return [1.0]


@cb.solve_task(split="train")
async def solve(task_cfg: cb.Task, session: cb.DesktopSession):
    """Demonstrate the solution."""

    content = task_cfg.metadata.get("content", "Hello!")
    filename = task_cfg.metadata.get("filename", "file.txt")

    # Step 1: Open Run dialog
    await session.execute_action(cb.HotkeyAction(keys=["win", "r"]))
    await session.execute_action(cb.WaitAction(seconds=0.5))

    # Step 2: Launch Notepad
    await session.execute_action(cb.TypeAction(text="notepad"))
    await session.execute_action(cb.KeyAction(key="Return"))
    await session.execute_action(cb.WaitAction(seconds=2.0))  # Windows apps are slower

    # Step 3: Type content
    await session.execute_action(cb.TypeAction(text=content))
    await session.execute_action(cb.WaitAction(seconds=0.5))

    # Step 4: Save file (Ctrl+S)
    await session.execute_action(cb.HotkeyAction(keys=["ctrl", "s"]))
    await session.execute_action(cb.WaitAction(seconds=1.0))

    # Step 5: Navigate to Desktop in Save dialog
    # Press Ctrl+L to focus location bar
    await session.execute_action(cb.HotkeyAction(keys=["ctrl", "l"]))
    await session.execute_action(cb.WaitAction(seconds=0.3))

    # Type Desktop path
    await session.execute_action(cb.TypeAction(text=r"%USERPROFILE%\Desktop"))
    await session.execute_action(cb.KeyAction(key="Return"))
    await session.execute_action(cb.WaitAction(seconds=0.5))

    # Step 6: Type filename
    # Tab to filename field
    await session.execute_action(cb.HotkeyAction(keys=["alt", "n"]))
    await session.execute_action(cb.WaitAction(seconds=0.3))
    await session.execute_action(cb.TypeAction(text=filename))

    # Step 7: Save
    await session.execute_action(cb.KeyAction(key="Return"))
    await session.execute_action(cb.WaitAction(seconds=1.0))
```

## Step 5: Add Task Metadata

Create `pyproject.toml`:

```toml
[project]
name = "win-notepad"
version = "0.1.0"

[tool.cua-bench]
description = "Create and save a file using Notepad on Windows"
difficulty = "medium"
category = "desktop"
tags = ["windows", "native", "notepad", "file-save"]
```

## Step 6: Run the Task

### Run Interactively

```bash
cb interact tasks/win-notepad --image windows-qemu --variant-id 0
```

Watch at `http://localhost:8006` while the oracle runs.

### Run with Oracle

```bash
cb run task tasks/win-notepad --image windows-qemu --oracle
```

### Run with Agent

```bash
cb run task tasks/win-notepad --image windows-qemu --agent cua-agent --model anthropic/claude-sonnet-4-20250514
```

## Windows-Specific Tips

### 1. Longer Wait Times

Windows applications take longer to launch than Linux apps:

```python
# Linux: 0.5-1 second
# Windows: 2-5 seconds

await session.execute_action(cb.WaitAction(seconds=3.0))  # After app launch
```

### 2. Use Keyboard Shortcuts

Windows has consistent keyboard shortcuts that are more reliable than clicking:

| Shortcut | Action |
|----------|--------|
| `Win + R` | Open Run dialog |
| `Win + E` | Open File Explorer |
| `Win + D` | Show Desktop |
| `Alt + F4` | Close window |
| `Ctrl + S` | Save |
| `Ctrl + Shift + S` | Save As |
| `Alt + Tab` | Switch windows |

### 3. Screen Resolution

Default Windows resolution is 1920x1080. Button coordinates differ from Linux:

```python
computer={
    "provider": "native",
    "setup_config": {
        "os_type": "windows",
        "width": 1920,
        "height": 1080,
    }
}
```

### 4. App-Specific Paths

Windows uses backslashes and has different paths:

```python
# Desktop path
desktop = r"%USERPROFILE%\Desktop"

# Documents
documents = r"%USERPROFILE%\Documents"

# Program Files
programs = r"C:\Program Files"
```

## Adding Complexity

### Multi-Application Task

```python
@cb.tasks_config(split="train")
def load():
    return [
        cb.Task(
            description="""
            1. Open Chrome and search for "Python tutorial"
            2. Copy the URL of the first result
            3. Open Notepad and paste the URL
            4. Save the file as "url.txt" on Desktop
            """,
            metadata={"search_query": "Python tutorial"},
            computer={
                "provider": "native",
                "setup_config": {"os_type": "windows", "width": 1920, "height": 1080}
            }
        )
    ]
```

### Using Pre-installed Apps

If you created an image with `--apps`:

```python
@cb.solve_task(split="train")
async def solve(task_cfg: cb.Task, session: cb.DesktopSession):
    # Open VS Code instead of Notepad
    await session.execute_action(cb.HotkeyAction(keys=["win", "r"]))
    await session.execute_action(cb.WaitAction(seconds=0.5))
    await session.execute_action(cb.TypeAction(text="code"))
    await session.execute_action(cb.KeyAction(key="Return"))
    await session.execute_action(cb.WaitAction(seconds=5.0))  # VS Code takes time
```

## Complete Code

<details>
<summary>main.py (complete)</summary>

```python
import cua_bench as cb
from pathlib import Path


@cb.tasks_config(split="train")
def load():
    """Define Notepad task variants."""
    return [
        cb.Task(
            description="""
            Open Notepad and type "Hello from Cua-Bench!".
            Then save the file as "greeting.txt" on the Desktop.
            """,
            metadata={
                "content": "Hello from Cua-Bench!",
                "filename": "greeting.txt",
                "save_location": "Desktop"
            },
            computer={
                "provider": "native",
                "setup_config": {
                    "os_type": "windows",
                    "width": 1920,
                    "height": 1080,
                }
            }
        )
    ]


@cb.setup_task(split="train")
async def start(task_cfg: cb.Task, session: cb.DesktopSession):
    """Initialize the Windows environment."""
    await session.execute_action(cb.WaitAction(seconds=5.0))


@cb.evaluate_task(split="train")
async def evaluate(task_cfg: cb.Task, session: cb.DesktopSession) -> list[float]:
    """Check if the file was created correctly."""
    screenshot = await session.screenshot()
    Path("debug_screenshot.png").write_bytes(screenshot)
    return [1.0]


@cb.solve_task(split="train")
async def solve(task_cfg: cb.Task, session: cb.DesktopSession):
    """Demonstrate the solution."""

    content = task_cfg.metadata.get("content", "Hello!")
    filename = task_cfg.metadata.get("filename", "file.txt")

    # Open Run dialog
    await session.execute_action(cb.HotkeyAction(keys=["win", "r"]))
    await session.execute_action(cb.WaitAction(seconds=0.5))

    # Launch Notepad
    await session.execute_action(cb.TypeAction(text="notepad"))
    await session.execute_action(cb.KeyAction(key="Return"))
    await session.execute_action(cb.WaitAction(seconds=2.0))

    # Type content
    await session.execute_action(cb.TypeAction(text=content))
    await session.execute_action(cb.WaitAction(seconds=0.5))

    # Save file
    await session.execute_action(cb.HotkeyAction(keys=["ctrl", "s"]))
    await session.execute_action(cb.WaitAction(seconds=1.0))

    # Navigate to Desktop
    await session.execute_action(cb.HotkeyAction(keys=["ctrl", "l"]))
    await session.execute_action(cb.WaitAction(seconds=0.3))
    await session.execute_action(cb.TypeAction(text=r"%USERPROFILE%\Desktop"))
    await session.execute_action(cb.KeyAction(key="Return"))
    await session.execute_action(cb.WaitAction(seconds=0.5))

    # Enter filename
    await session.execute_action(cb.HotkeyAction(keys=["alt", "n"]))
    await session.execute_action(cb.WaitAction(seconds=0.3))
    await session.execute_action(cb.TypeAction(text=filename))

    # Save
    await session.execute_action(cb.KeyAction(key="Return"))
    await session.execute_action(cb.WaitAction(seconds=1.0))
```

</details>

<details>
<summary>pyproject.toml</summary>

```toml
[project]
name = "win-notepad"
version = "0.1.0"

[tool.cua-bench]
description = "Create and save a file using Notepad on Windows"
difficulty = "medium"
category = "desktop"
tags = ["windows", "native", "notepad", "file-save"]
```

</details>

## Troubleshooting

### KVM not available

```bash
# Check KVM
ls -la /dev/kvm

# If missing on cloud VM, enable nested virtualization
# or use a bare-metal server
```

### Windows hangs during setup

- Increase memory: `--memory 16G`
- Increase CPUs: `--cpus 8`
- Use `--no-kvm` for slower but more compatible emulation

### App doesn't launch

- Increase wait times after launching apps
- Use keyboard shortcuts instead of mouse clicks
- Verify the app is installed with `cb image shell`

## Next Steps

- [Generate Tasks with AI](/cuabench/guide/examples/genai-task-generation)
- Explore [Windows Arena](/cuabench/guide/fundamentals/native-tasks) benchmark
- See [Configuration](/cuabench/guide/advanced/configuration) for advanced settings
