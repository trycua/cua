<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cua-bench</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://cdn.jsdelivr.net/npm/iconify-icon@3.0.2/dist/iconify-icon.min.js"></script>
    <link rel="stylesheet" href="/css/{{ os_type }}.css" />
    <link rel="stylesheet" href="/iconsets/{{ os_type }}.css" />
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        .window-body {
            background-color: #fff;
            color: #000;
        }
    </style>
</head>
<body data-appearance="{{ os_type }}">
    <div
        class="computer"
        style="
            width: {{ width }}px;
            height: {{ height }}px;
            background: {{ background }};
        "
    >
        <!-- Status Bar (Android/iOS) -->
        {% if os_type == 'android' or os_type == 'ios' %}
        <div class="statusbar" role="banner" aria-label="Mobile status bar">
            <div class="statusbar-left">
                <span class="clock" aria-label="Time">18:00</span>
            </div>
            <div class="statusbar-center">
                <span class="notch" aria-hidden="true"></span>
            </div>
            <div class="statusbar-right">
                <span class="status">ðŸ“¶</span>
                <span class="status">ðŸ”‹</span>
            </div>
        </div>
        {% endif %}
        
        <!-- Menubar (macOS) -->
        {% if os_type == 'macos' %}
        <div class="menubar">
            <div class="menubar-left">
                <span class="apple" aria-hidden="true"></span>
                <span class="menu-item-app">Finder</span>
                <span class="menu-item">File</span>
                <span class="menu-item">Edit</span>
                <span class="menu-item">View</span>
                <span class="menu-item">Go</span>
                <span class="menu-item">Window</span>
                <span class="menu-item">Help</span>
            </div>
            <div class="menubar-right">
                <span class="status" data-instruction="spotlight search"><span class="material-symbols--search" style="width: 16px; height: 16px;"></span></span>
                <span class="clock">Tue Apr 11 11:34 PM</span>
            </div>
        </div>
        {% endif %}
        
        <!-- Desktop Icons (macOS, Windows) -->
        {% if os_type != 'android' and os_type != 'ios' %}
        <div class="desktop-icons">
            {% for icon in desktop_icons %}
            <div class="desktop-icon" title="{{ icon.title }}">
                <div class="icon" data-icon="{{ icon.icon }}" aria-label="{{ icon.title }}" data-instruction="open {{ icon.title }} on desktop"></div>
                <span class="label">{{ icon.title }}</span>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        <!-- Application Windows -->
        {% for window in windows %}
        <div class="window" 
                data-focused="{{ 'true' if window.focused else 'false' }}" 
                data-titlebar-style="{{ window.title_bar_style }}"
                style="left: {{ window.x }}px; top: {{ window.y }}px; width: {{ window.width }}px; height: {{ window.height }}px">
            {% if window.title_bar_style != 'hidden' %}
            <div class="title-bar">
                <div class="title-bar-text">
                    {% if window.icon %}
                    <div class="icon" data-icon="{{ window.icon }}" aria-hidden="true"></div>
                    {% endif %}
                    <span class="title">{{ window.title }}</span>
                </div>
                <div class="title-bar-controls">
                    <button class="btn" aria-label="Minimize" data-instruction="minimize the window"></button>
                    <button class="btn" aria-label="Maximize" data-instruction="maximize the window"></button>
                    <button class="btn" aria-label="Close" data-instruction="close the window"></button>
                </div>
            </div>
            {% endif %}
            <div class="window-body">
                {{ window.content }}
            </div>
        </div>
        {% endfor %}
        
        <!-- Taskbar (Windows 11 style, semantic classes) -->
        {% if os_type != 'android' and os_type != 'ios' and os_type != 'macos' %}
        <footer class="taskbar" aria-label="Taskbar">
            <nav class="taskbar-apps" aria-label="Taskbar apps">
                <button class="taskbar-item" aria-label="Start" data-instruction="open start menu"></button>
                <ul class="app-list" aria-label="Pinned apps">
                    {% for app in taskbar_state.pinned_apps %}
                    <li class="taskbar-item{% if app.active %} active{% endif %}" title="{{ app.title }}" aria-label="{{ app.title }}" data-instruction="open {{ app.title }}">
                        <div class="icon" data-icon="{{ app.icon }}" aria-hidden="true"></div>
                        <!-- <span class="label">{{ app.title }}</span> -->
                    </li>
                    {% endfor %}
                    {% for app in taskbar_state.open_apps %}
                    <li class="taskbar-item open{% if app.active %} active{% endif %}" title="{{ app.title }}" aria-label="{{ app.title }}" data-instruction="focus {{ app.title }}">
                        <div class="icon" data-icon="{{ app.icon }}" aria-hidden="true"></div>
                        <span class="label">{{ app.title }}</span>
                    </li>
                    {% endfor %}
                    {% for window in windows %}
                    <li class="taskbar-item open{% if window.focused %} active{% endif %}" title="{{ window.title }}" aria-label="{{ window.title }}" data-instruction="{% if window.focused %}minimize {% else %}focus {% endif %}{{ window.title }}">
                        <div class="icon" data-icon="{{ window.icon }}" aria-hidden="true"></div>
                        <span class="label">{{ window.title }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </nav>
            <div class="system-tray" aria-label="System tray">
                <button class="taskbar-item" aria-label="Expand tray" data-instruction="expand tray">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6Z" fill="currentColor"/>
                    </svg>
                </button>
                <button class="taskbar-item" aria-label="Network" data-instruction="configure network">
                    <svg width="16" height="14" viewBox="0 0 16 14" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M12 13.242c0-.088.016-.158.047-.21.036-.057.083-.117.14-.18.073-.073.151-.141.235-.203.083-.067.164-.137.242-.21.375-.344.708-.724 1-1.14.291-.422.536-.867.734-1.336.198-.469.347-.953.446-1.453.104-.5.156-1.003.156-1.508 0-.5-.052-1-.156-1.5a7.67 7.67 0 0 0-.453-1.461 7.55 7.55 0 0 0-.734-1.328 7.52 7.52 0 0 0-1-1.164 6.2 6.2 0 0 0-.242-.226 3.3 3.3 0 0 1-.235-.211c-.062-.062-.109-.12-.141-.172A.41.41 0 0 1 12 .75c0-.141.047-.258.141-.352.099-.094.219-.141.36-.141.062 0 .117.01.164.031.047.016.096.042.148.078.235.151.467.344.696.578.229.235.445.487.648.758.208.266.398.54.57.82.172.281.318.547.438.797.276.578.484 1.177.625 1.797.141.614.211 1.242.211 1.883 0 .636-.07 1.266-.211 1.891a9.9 9.9 0 0 1-.625 1.789 6.7 6.7 0 0 1-.438.797 6.9 6.9 0 0 1-.57.82c-.141.203-.292.393-.453.57-.151.176-.302.317-.453.421a.58.58 0 0 1-.492.207.53.53 0 0 1-.352-.149.486.486 0 0 1-.148-.355ZM3.297 10H1.5a1.8 1.8 0 0 1-.578-.117 1.71 1.71 0 0 1-.484-.32 1.58 1.58 0 0 1-.32-.5A1.67 1.67 0 0 1 0 8.5v-3c0-.203.039-.396.117-.578.078-.182.185-.341.32-.477.141-.141.302-.25.484-.328.183-.078.376-.117.579-.117h1.797L5.72 1.57c.073-.073.154-.125.242-.156.094-.036.19-.055.289-.055.214 0 .391.07.531.211.146.141.219.318.219.531v9.797c0 .104-.021.2-.062.289a.66.66 0 0 1-.164.242.78.78 0 0 1-.242.164.62.62 0 0 1-.281.055.79.79 0 0 1-.531-.219L3.297 10Z" fill="currentColor"/>
                    </svg>
                </button>
                <div class="date-time taskbar-item" aria-label="Date and time" data-instruction="configure date and time">
                    <span aria-label="Time">2:50 AM</span>
                    <span aria-label="Date">9/5/2023</span>
                </div>
            </div>
            <button aria-label="Show desktop"></button>
        </footer>
        {% endif %}
        
        <!-- Dock (macOS) -->
        {% if os_type == 'macos' %}
        <div class="dock" aria-label="Dock">
            {% for app in dock_state.pinned_apps %}
            <button class="dock-item icon" data-icon="{{ app.icon }}" title="{{ app.title }}" aria-label="{{ app.title }}" data-instruction="open {{ app.title }}"></button>
            {% endfor %}
            {% if dock_state.recent_apps and dock_state.pinned_apps %}
            <span class="sep" aria-hidden="true"></span>
            {% endif %}
            {% for app in dock_state.recent_apps %}
            <button class="dock-item icon" data-icon="{{ app.icon }}" title="{{ app.title }}" aria-label="{{ app.title }}" data-instruction="open {{ app.title }}"></button>
            {% endfor %}
            {% if dock_state.pinned_folders and (dock_state.recent_apps or dock_state.pinned_apps) %}
            <span class="sep" aria-hidden="true"></span>
            {% endif %}
            {% for folder in dock_state.pinned_folders %}
            <button class="dock-item icon" data-icon="{{ folder.icon }}" title="{{ folder.title }}" aria-label="{{ folder.title }}" data-instruction="open {{ folder.title }}"></button>
            {% endfor %}
        </div>
        {% endif %}
        
        <!-- Navigation Bar (Android/iOS) -->
        {% if os_type == 'android' or os_type == 'ios' %}
        <nav class="navbar" aria-label="Mobile navigation bar">
            <button class="nav-btn" aria-label="Back">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                </svg>
            </button>
            <button class="nav-btn" aria-label="Home">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M12 3 2 12h3v8h6v-6h2v6h6v-8h3z"/>
                </svg>
            </button>
            <button class="nav-btn" aria-label="Recent">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <rect x="7" y="7" width="10" height="10" rx="1"/>
                </svg>
            </button>
        </nav>
        {% endif %}
    </div>
    
    <script>
        // Automatically update date and time displays
        function updateDateTime() {
            const now = new Date();
            
            // Format for mobile status bar (24-hour format)
            const mobileTime = now.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false 
            });
            
            // Format for macOS menubar
            const macosTime = now.toLocaleString('en-US', {
                weekday: 'short',
                month: 'short',
                day: 'numeric',
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            }).split(",").join("");
            
            // Format for Windows taskbar
            const windowsTime = now.toLocaleTimeString('en-US', { 
                hour: 'numeric', 
                minute: '2-digit',
                hour12: true 
            });
            const windowsDate = now.toLocaleDateString('en-US', {
                month: 'numeric',
                day: 'numeric',
                year: 'numeric'
            });
            
            // Update mobile status bar clock
            const statusbarClock = document.querySelector('.statusbar .clock');
            if (statusbarClock) {
                statusbarClock.textContent = mobileTime;
            }
            
            // Update macOS menubar clock
            const menubarClock = document.querySelector('.menubar .clock');
            if (menubarClock) {
                menubarClock.textContent = macosTime;
            }
            
            // Update Windows taskbar date/time
            const taskbarTime = document.querySelector('.date-time [aria-label="Time"]');
            const taskbarDate = document.querySelector('.date-time [aria-label="Date"]');
            if (taskbarTime) {
                taskbarTime.textContent = windowsTime;
            }
            if (taskbarDate) {
                taskbarDate.textContent = windowsDate;
            }
        }
        
        // Update immediately on load
        updateDateTime();
        
        // Update every second
        setInterval(updateDateTime, 1000);
    </script>
</body>
</html>
